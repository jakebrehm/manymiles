{% extends "main/index.html" %}

{% block css %}
        <!-- Font Awesome CSS stylesheets -->
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

        <!-- Blueprint-specific style -->
        <link rel="stylesheet" href="{{ url_for('main.static', filename='css/style.css') }}">
{% endblock %}

{% block body %}
    <!-- Main container -->
    <main class="container">
        <article>
            <header class="thin-card">
                <h4 class="no-bottom-margin">Add a new record</h4>
            </header>
            <form method="post" action="/add_record">
                <div class="grid">
                    <div>
                        <label class="no-bottom-margin" for="timestamp">Timestamp
                            <input class="no-bottom-margin" type="datetime-local" id="timestamp" aria-label="Timestamp" name="timestamp" required>
                        </label>
                    </div>
                    <div>
                        <label class="no-bottom-margin" for="mileage">Mileage
                            <input class="no-bottom-margin" type="number" id="mileage" aria-label="Mileage" name="mileage" required>
                        </label>
                    </div>
                </div>
                <button class="no-bottom-margin" style="margin-top: 10px;">Submit</button>
            </form>
        </article>

        {% if records.items %}
        <div class="container">
            <table role="grid">
                <thead>
                    <th style="width: 15%;">Date</th>
                    <th style="width: 15%;">Time</th>
                    <th style="width: 15%;">Mileage</th>
                    <th style="width: 42%;" class="desktop-only">Notes</th>
                    <!-- <th></th> -->
                    <th style="width: 13%;"></th>
                </thead>
            {% for record in records.items %}
                <tr>
                    <td>{{ record.recorded_datetime.strftime("%Y-%m-%d") }}</td>
                    <td>{{ record.recorded_datetime.strftime("%-I:%M %p") }}</td>
                    <td>{{ record.mileage }}</td>
                    <td style="width: 42%;" class="desktop-only">{{ record.notes if record.notes else "" }}</td>
                    <td style="width: 13%">
                        <a style="width: 50px" href="/update?record={{ record.record_id }}" class="record-button" role="button">
                            <i class="fa fa-edit" aria-hidden="true"></i>
                        </a>
                        <a style="width: 50px" href="/delete_record?record={{ record.record_id }}" class="record-button deep-red" role="button">
                            <i class="fa fa-trash-o" aria-hidden="true"></i>
                        </a>
                    </td>
                </tr>
            {% endfor %}
            </table>

            <div class="row">
                <div class="col-sm-8" style="align-self: center !important">
                    <div class="desktop-only">
                    Page {{ records.page }} of {{ records.pages }}: 
                    {% for page in records.iter_pages(left_edge=2, right_edge=2, left_current=2, right_current=2) %}
                        {% if page %}
                        <a href="{{ url_for('main.records', page_num=page, per_page=records.per_page) }}" style="padding: 5px;">{{page}}</a>
                        {% else %}
                        ...
                        {% endif %}
                    {% endfor %}
                    </div>
                </div>
                <div class="col-sm-4">
                    <div style="float: right !important;">
                        {% if records.prev_num %}
                        <a href="{{ url_for('main.records', page_num=records.prev_num, per_page=records.per_page) }}" role="button" class="secondary pagination-button">
                            <i class="fa fa-arrow-left" aria-hidden="true"></i>
                        </a>
                        {% endif %}
                        {% if records.next_num %}
                        <a href="{{ url_for('main.records', page_num=records.next_num, per_page=records.per_page) }}" role="button" class="pagination-button">
                            <i class="fa fa-arrow-right" aria-hidden="true"></i>
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    </main>
{% endblock %}

{% block javascript %}
    <script src="{{ url_for('main.static', filename='js/render_table.js') }}"></script>
{% endblock %}